<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Leaderboard | The System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(to right, #0f0c29, #302b63, #24243e);
      color: #e0f7ff;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #00eaff;
    }

    .leaderboard-container {
      max-width: 900px;
      margin: 0 auto;
    }

    .user-card {
      background: rgba(0, 0, 32, 0.35);
      border: 1px solid #00eaff22;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 0 12px #00eaff33;
    }

    .user-name {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .xp-bar-background {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      height: 20px;
      overflow: hidden;
      margin: 10px 0;
    }

    .xp-bar-fill {
      background: #00eaff;
      height: 100%;
      width: 1%; /* default */
    }

    .level-text {
      font-size: 0.9rem;
      color: #aad;
      margin-top: 5px;
    }

    .topbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: rgba(0, 0, 32, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .sidebar {
      position: fixed;
      top: 60px;
      left: 0;
      bottom: 0;
      width: 220px;
      background: rgba(0, 0, 32, 0.7);
      padding-top: 20px;
    }

    .main-panel {
      margin-left: 220px;
      margin-top: 60px;
      padding: 20px;
    }
  </style>
</head>
<body class="dark-body">
  <header class="topbar"><h1 class="system-title">ğŸŒ€ The System</h1></header>
  <aside class="sidebar">
    <a href="dashboard.html" class="nav-btn">ğŸ  Dashboard</a>
    <a href="mission.html" class="nav-btn">ğŸ“† Daily Missions</a>
    <a href="leaderboard.html" class="nav-btn">ğŸ† Leaderboard</a>
    <a href="streak.html" class="nav-btn">ğŸ”¥ Streak</a>
  </aside>
  <main class="main-panel">
    <h1>ğŸ† Leaderboard</h1>
    <div class="leaderboard-container" id="leaderboard">
      <!-- Leaderboard will be populated dynamically from Firebase -->
    </div>
  </main>
</body>
<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyB6Em8uDp3p_8W1Nf1kMhUH0GTXkInmR2c",
    authDomain: "game-of-life-d0cf4.firebaseapp.com",
    databaseURL: "https://game-of-life-d0cf4-default-rtdb.firebaseio.com",
    projectId: "game-of-life-d0cf4",
    storageBucket: "game-of-life-d0cf4.appspot.com",
    messagingSenderId: "393447467234",
    appId: "1:393447467234:web:9eafe313c78b8610c856bb"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const leaderboardContainer = document.getElementById("leaderboard");
  leaderboardContainer.innerHTML = ""; // Clear sample users

 firebase.auth().onAuthStateChanged(user => {
  if (user) {
   db.collection("students").get().then(querySnapshot => {
      querySnapshot.forEach(doc => {
        const userData = doc.data();
       const name = userData.name || "Unnamed";

        const card = document.createElement("div");
        card.className = "user-card";
        card.innerHTML = `
          <div class="user-name">ğŸ‘¤ ${name} - Fellow Competitor</div>
          <div class="level-text">ğŸ¯ Field: ${userData.field || 'N/A'} | Level: ${userData.current || 'N/A'} | Grade: ${userData.grade || '0'}</div>
          <div class="xp-bar-background">
            <div class="xp-bar-fill" style="width: ${(parseInt(userData.grade) || 1) * 10}%;"></div>
          </div>`;
        leaderboardContainer.appendChild(card);
      });
    }).catch(error => {
      console.error("Firestore error:", error.message);
      leaderboardContainer.innerHTML = `<div class="user-name">âŒ Firestore read failed: ${error.message}</div>`;
    });
  } else {
    leaderboardContainer.innerHTML = `<div class="user-name">âš ï¸ Please sign in to view the leaderboard.</div>`;
  }
});


</script>
</html>